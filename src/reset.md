# 重置与重载
---
本栏目将教会你如何重置并重载你的设备配置文件。

当你第一次拿到一台新机器的时候，你可能会发现里面有一些配置文件没有被清理干净，不处理好的话会对后续操作造成意想不到的阻碍。

更有甚者可能直接进不了管理视图

## 那咋办嘞？

**猜你关注：如果你在寻找如何不停机软重启，那你没找错，但是我需要先讲一下其他的重点。如果你已经知道了，不妨翻到本文最下面去寻找。**

---

## 思科交换机&路由器 删除用户数据
本段内容是为无法进入设备管理视图的朋友们准备的。

> **适用场景：**  
> - 不知道 enable 密码  
> - Console 能进，但进不了特权模式  
> - 一开机就要用户名 / 密码，完全没辙  

简单说：**你已经被前任管理员锁在门外了。**

这时候，唯一的办法就是——  
**绕过启动配置，把设备“骗”进来。**

---

### 思路先讲清楚（很重要）

在 **Cisco** 设备上：

- 所有用户、密码、接口配置  
- 都存放在 **startup-config** 里  
- 设备开机时会自动加载它  

我们要做的事本质上是**让设备启动时“看不到”原来的配置文件。**

---

### 操作步骤

#### 1️⃣ 通过 Console 重启设备

直接断电重启，或者在你还能敲命令的情况下：

reload

---

#### 2️⃣ 开机过程中打断启动，进入 ROMmon

设备刚上电时，注意看终端模拟器中的提示，通常是类似：

Press Break or Ctrl+Break to enter ROMMON

他让你按什么键你疯狂按就完了。

成功后你会看到类似：

rommon 1 >

---

#### 3️⃣ 忽略原有启动配置

在 ROMmon 模式下输入：

confreg 0x2142

然后重启：

reset

这一步的效果是：

> **告诉设备：下次启动时不要加载 startup-config**

---

#### 4️⃣ 设备会OOBE启动

这时候你会看到熟悉的提示：

Would you like to enter the initial configuration dialog? [yes/no]:

直接输入：

no

然后你就会：

✅ 直接进入特权模式  
✅ 不需要密码  
✅ 原配置还在，但暂时没生效  

~~至于打YES会怎么样？不会有什么大乱子，只是你要绕个大弯子。你可以去packet tracer试试看。~~

---

#### 5️⃣ 删除原有配置文件（重点）

现在可以动手了：

enable
write erase

或：

erase startup-config

如果是交换机，**一定要再来一句：**

delete flash:vlan.dat

（不然 VLAN 会阴魂不散）

---

#### 6️⃣ 恢复正常启动方式

非常重要的一步，别忘了：

configure terminal
config-register 0x2102
end
write memory
reload

至此，设备已经是**真正的“裸机状态”**了。

---

### 小提醒（踩坑预警）

- ❌ 忘了改回 `config-register 0x2102`  
  → 下次重启还会忽略配置  
- ❌ 忘了删 `vlan.dat`  
  → VLAN 配置“重生”  
- ❌ 以为这是“软重启”栏目的内容
  → 这是**彻底清空配置文件**

---

## 思科交换机&路由器 删除启动配置
本段内容是为可以进入设备管理视图但是不知道怎么快速重置的朋友们准备的。

### 最快、最干净的方式

#### 1️⃣ 进入特权模式

enable

---

#### 2️⃣ 删除启动配置

write erase

或：

erase startup-config

看到提示确认即可。

---

#### 3️⃣ 交换机额外一步（非常重要）

如果你用的是交换机：

delete flash:vlan.dat

不然你会遇到：

- VLAN 还在  
- 端口莫名其妙在奇怪的 VLAN 里  
- “我不是已经清空了吗？”的经典疑问  

---

#### 4️⃣ 重启设备

reload

不保存，直接重启。

---

### 重启后的状态

重启完成后，你会得到一台：

- 没有 IP
- 没有用户
- 没有 VLAN
- 没有接口配置  

**真正意义上的“白板设备”。**

---

### 一句话总结

- **进不去设备？**  
  👉 ROMmon + 忽略配置 + 删除  
- **进得去设备？**  
  👉 `write erase` + `reload`  

能简单解决的事，就别把事情搞复杂。

如果你只是来看软重启的，那打个reload再回车就好了。抱歉让你看了这么多废话。
